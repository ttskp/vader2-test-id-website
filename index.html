<html>

<body>
  <div class="container">
  </div>
  <script type="module">
    
    const createDiv = (...cbs) => {
      const el = document.createElement('div');
      [...cbs].reduce((el, cb) => cb(el), el)
      return el;
    }
    
    const withText = (text) => (el) => {
      el.innerText = text;
      return el;
    }

    
    async function sha256(message) {
      // encode as UTF-8
      const msgBuffer = new TextEncoder().encode(message);                    

      // hash the message
      const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);

      // convert ArrayBuffer to Array
      const hashArray = Array.from(new Uint8Array(hashBuffer));

      // convert bytes to hex string                  
      const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
      return hashHex;
    }  
    
    const arr = await fetch("./test.json").then(r => r.json());
    const result = await Promise.all(arr.map(async (entry) => {
      const hash = await sha256(entry);
      
      return {
        entry,
        hash,
        hashWithModulo: parseInt(hash, 16) % 50000
      }
    }));
    
    const elements = result.map(entry => {
      return [
        createDiv(withText(result.entry)),
        createDiv(withText(result.hash)),
        createDiv(withText(result.hashWithModulo))
     ]
    });
    
    console.log(result);
    console.log(elements);
    
    
  </script>
</body>
</html>
